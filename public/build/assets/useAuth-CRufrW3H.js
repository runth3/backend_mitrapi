import{d as g,_ as f,c as m,w as h,n as v,z as y,o as S,r as I,b as l,u as k}from"./main-_i2oXPUW.js";const w=g({name:"BaseButton",props:{color:{type:String,default:"primary"},size:{type:String,default:"default"},variant:{type:String,default:"elevated"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},block:{type:Boolean,default:!1},customClass:{type:String,default:""},prependIcon:{type:String,default:void 0},appendIcon:{type:String,default:void 0},rounded:{type:String,default:"lg"}},emits:["click"]});function b(e,n,r,s,i,d){return S(),m(y,{color:e.color,size:e.size,variant:e.variant,disabled:e.disabled,loading:e.loading,block:e.block,"prepend-icon":e.prependIcon,"append-icon":e.appendIcon,rounded:e.rounded,class:v(["v-btn-custom",e.customClass]),onClick:n[0]||(n[0]=c=>e.$emit("click"))},{default:h(()=>[I(e.$slots,"default",{},void 0,!0)]),_:3},8,["color","size","variant","disabled","loading","block","prepend-icon","append-icon","rounded","class"])}const A=f(w,[["render",b],["__scopeId","data-v-17507ecc"]]);function C(){const e=k(),n=l(!1),r=l(null),s=l(!1);async function i(o,u){n.value=!0,r.value=null;try{console.log("Attempting to login with username:",o);const a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:o,password:u})});if(!a.ok){const p=await a.json();throw new Error(p.message||"Login failed")}const t=await a.json();if(console.log("Login response:",t),t.status!=="success")throw new Error(t.message||"Login failed");localStorage.setItem("auth_token",t.data.access_token),localStorage.setItem("userData",JSON.stringify(t.data.user)),localStorage.setItem("is_admin",t.data.user.is_admin.toString()),s.value=t.data.user.is_admin===1,console.log("Redirecting to /dashboard"),await e.push("/dashboard"),console.log("Redirect completed")}catch(a){throw r.value=a.message||"Invalid username or password",console.error("Login error:",a),a}finally{n.value=!1}}async function d(){try{const o=localStorage.getItem("auth_token");o&&await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${o}`}})}catch(o){console.error("Logout API failed:",o)}finally{localStorage.removeItem("auth_token"),localStorage.removeItem("userData"),localStorage.removeItem("is_admin"),s.value=!1,await e.push("/login")}}function c(){const o=localStorage.getItem("is_admin");s.value=o==="1"}return c(),{login:i,logout:d,error:r,loading:n,isAdmin:s}}export{A as B,C as u};
