import{d as y,B as w,a as B,b as l,_ as b,r as a,c as k,o as c,e as t,w as n,f as i,g as V,h as I,i as $,t as C}from"./app-ClbCorYk.js";const L=y({name:"Login",components:{BaseInput:B,BaseButton:w},data(){return{username:"",password:"",error:null,loading:!1}},methods:{async handleLogin(){var e,o;this.loading=!0,this.error=null;try{const s=await l.post("/api/auth/login",{username:this.username,password:this.password},{headers:{Accept:"application/json","Content-Type":"application/json"}});s.data.access_token?(localStorage.setItem("token",s.data.access_token),l.defaults.headers.common.Authorization=`Bearer ${s.data.access_token}`,await this.fetchUserProfile(),this.$router.push({name:"Dashboard"})):this.error="Invalid response from server"}catch(s){console.error("Login error:",s),this.error=((o=(e=s.response)==null?void 0:e.data)==null?void 0:o.message)||"Login failed. Please check your credentials and try again."}finally{this.loading=!1}},async fetchUserProfile(){try{const e=await l.get("/api/profile/me",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e.data),localStorage.setItem("userData",JSON.stringify(e.data.user))}catch(e){console.error("Failed to fetch user profile:",e)}}}}),S={class:"login-background"};function j(e,o,s,U,x,A){const p=a("v-img"),m=a("v-card-title"),d=a("BaseInput"),u=a("BaseButton"),g=a("v-form"),f=a("v-alert"),_=a("v-card-text"),h=a("v-card"),v=a("v-container");return c(),k("div",S,[t(v,{class:"d-flex justify-center align-center pa-5",style:{"min-height":"100vh",height:"100%"}},{default:n(()=>[t(h,{class:"pa-5 login-card","max-width":"600",elevation:"3"},{default:n(()=>[t(p,{src:"/images/logo.png","max-width":"150",class:"mx-auto mb-4"}),t(m,{class:"text-h5 text-center"},{default:n(()=>o[3]||(o[3]=[i("Login")])),_:1}),t(_,null,{default:n(()=>[t(g,{onSubmit:$(e.handleLogin,["prevent"])},{default:n(()=>[t(d,{modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=r=>e.username=r),label:"Username"},null,8,["modelValue"]),t(d,{modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=r=>e.password=r),label:"Password",type:"password"},null,8,["modelValue"]),t(u,{type:"submit",loading:e.loading,disabled:e.loading},{default:n(()=>o[4]||(o[4]=[i(" Login ")])),_:1},8,["loading","disabled"])]),_:1},8,["onSubmit"]),e.error?(c(),V(f,{key:0,type:"error",class:"mt-4",dense:"",closable:"","onClick:close":o[2]||(o[2]=r=>e.error=null)},{default:n(()=>[i(C(e.error),1)]),_:1})):I("",!0)]),_:1})]),_:1})]),_:1})])}const P=b(L,[["render",j],["__scopeId","data-v-b42d2a3d"]]);export{P as default};
