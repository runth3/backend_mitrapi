import{d as y,D as h,a as d,m as b,_ as P,r,c as n,o as i,w as t,b as a,e as p,g as C}from"./app-B2iXRY-s.js";const k=y({name:"Profile",components:{DefaultLayout:h},data(){return{menuItems:b,loading:!1,saving:!1,valid:!1,profile:{name:"",email:"",current_password:"",new_password:"",new_password_confirmation:""}}},methods:{async fetchProfile(){try{this.loading=!0;const e=await d.get("/api/profile",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});this.profile.name=e.data.name,this.profile.email=e.data.email}catch(e){console.error("Failed to fetch profile:",e)}finally{this.loading=!1}},async saveProfile(){if(this.valid)try{this.saving=!0,await d.put("/api/profile",this.profile,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),this.profile.current_password="",this.profile.new_password="",this.profile.new_password_confirmation=""}catch(e){console.error("Failed to save profile:",e)}finally{this.saving=!1}},logout(){localStorage.removeItem("token"),this.$router.push({name:"Login"})}},mounted(){this.fetchProfile()}});function S(e,l,$,N,U,I){const u=r("v-card-title"),m=r("v-progress-linear"),s=r("v-text-field"),f=r("v-btn"),w=r("v-form"),_=r("v-card-text"),c=r("v-card"),v=r("v-col"),g=r("v-row"),V=r("default-layout");return i(),n(V,{title:"Profile","menu-items":e.menuItems,onLogout:e.logout},{default:t(()=>[a(g,null,{default:t(()=>[a(v,{cols:"12",md:"6","offset-md":"3"},{default:t(()=>[a(c,null,{default:t(()=>[a(u,null,{default:t(()=>l[6]||(l[6]=[p("Profile Settings")])),_:1}),a(_,null,{default:t(()=>[e.loading?(i(),n(m,{key:0,indeterminate:"",color:"primary"})):(i(),n(w,{key:1,ref:"form",modelValue:e.valid,"onUpdate:modelValue":l[5]||(l[5]=o=>e.valid=o),onSubmit:C(e.saveProfile,["prevent"])},{default:t(()=>[a(s,{modelValue:e.profile.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.profile.name=o),label:"Name",rules:[o=>!!o||"Name is required"],required:""},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.email,"onUpdate:modelValue":l[1]||(l[1]=o=>e.profile.email=o),label:"Email",rules:[o=>!!o||"Email is required",o=>/.+@.+\..+/.test(o)||"Email must be valid"],required:""},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.current_password,"onUpdate:modelValue":l[2]||(l[2]=o=>e.profile.current_password=o),label:"Current Password",type:"password",rules:[o=>!o||o.length>=8||"Password must be at least 8 characters"]},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.new_password,"onUpdate:modelValue":l[3]||(l[3]=o=>e.profile.new_password=o),label:"New Password",type:"password",rules:[o=>!o||o.length>=8||"Password must be at least 8 characters"]},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.new_password_confirmation,"onUpdate:modelValue":l[4]||(l[4]=o=>e.profile.new_password_confirmation=o),label:"Confirm New Password",type:"password",rules:[o=>!o||o===e.profile.new_password||"Passwords must match"]},null,8,["modelValue","rules"]),a(f,{color:"primary",type:"submit",loading:e.saving,disabled:!e.valid},{default:t(()=>l[7]||(l[7]=[p(" Save Changes ")])),_:1},8,["loading","disabled"])]),_:1},8,["modelValue","onSubmit"]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["menu-items","onLogout"])}const q=P(k,[["render",S]]);export{q as default};
