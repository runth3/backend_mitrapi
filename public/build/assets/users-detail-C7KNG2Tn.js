import{d as A,b,_ as S,r as o,g as m,o as i,w as t,e as s,f as d,c as p,F as c,j as V,t as f}from"./app-ClbCorYk.js";import{D as E,m as q}from"./menu-DXkp5gbb.js";const B=A({name:"Users Detail",components:{DefaultLayout:E},data(){return{menuItems:q,loading:!1,saving:!1,valid:!1,UsersDetail:{name:"",email:"",username:"",phone:"",dob:"",address:"",current_password:"",new_password:"",new_password_confirmation:""},additionalData:{},userId:null}},methods:{async fetchUsersDetail(){try{this.loading=!0;const e=await b.get(`/api/users/${this.userId}`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e.data),this.UsersDetail.name=e.data.user.name,this.UsersDetail.email=e.data.user.email,this.UsersDetail.username=e.data.user.username,this.UsersDetail.phone=e.data.user.phone,this.UsersDetail.dob=e.data.user.dob,this.UsersDetail.address=e.data.user.address,this.additionalData={dataPegawaiSimpeg:e.data.dataPegawaiSimpeg,dataPegawaiAbsen:e.data.dataPegawaiAbsen,dataPegawaiEkinerja:e.data.dataPegawaiEkinerja,userAbsen:e.data.userAbsen,userEkinerja:e.data.userEkinerja}}catch(e){console.error("Failed to fetch User Detail:",e)}finally{this.loading=!1}},async saveUsersDetail(){if(this.valid)try{this.saving=!0,await b.put(`/api/users/${this.userId}`,this.UsersDetail,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),this.UsersDetail.current_password="",this.UsersDetail.new_password="",this.UsersDetail.new_password_confirmation=""}catch(e){console.error("Failed to save Users Detail:",e)}finally{this.saving=!1}},logout(){localStorage.removeItem("token"),this.$router.push({name:"Login"})},formatKey(e){return e.replace(/([A-Z])/g," $1").replace(/^./,l=>l.toUpperCase())},formatSubKey(e){return typeof e=="number"?e.toString():e.replace(/([A-Z])/g," $1").replace(/^./,l=>l.toUpperCase())},isObject(e){return typeof e=="object"&&e!==null}},mounted(){this.userId=parseInt(this.$route.params.id,10),this.userId?this.fetchUsersDetail():console.error("User ID not found in route parameters.")}}),F={key:1};function L(e,l,N,K,M,T){const U=o("v-card-title"),h=o("v-progress-linear"),r=o("v-text-field"),n=o("v-col"),u=o("v-row"),_=o("v-btn"),y=o("v-form"),I=o("v-list-item-title"),P=o("v-list-item-subtitle"),k=o("v-list-item"),C=o("v-list"),D=o("v-card-text"),w=o("v-card"),$=o("default-layout");return i(),m($,{title:"User Detail","menu-items":e.menuItems,onLogout:e.logout},{default:t(()=>[s(u,null,{default:t(()=>[s(n,{cols:"12",md:"10","offset-md":"1"},{default:t(()=>[s(w,null,{default:t(()=>[s(U,null,{default:t(()=>l[10]||(l[10]=[d("User Detail Settings")])),_:1}),s(D,null,{default:t(()=>[e.loading?(i(),m(h,{key:0,indeterminate:"",color:"primary"})):(i(),p("div",F,[s(y,{ref:"form",modelValue:e.valid,"onUpdate:modelValue":l[9]||(l[9]=a=>e.valid=a)},{default:t(()=>[s(u,null,{default:t(()=>[s(n,{cols:"12",md:"6"},{default:t(()=>[s(r,{modelValue:e.UsersDetail.name,"onUpdate:modelValue":l[0]||(l[0]=a=>e.UsersDetail.name=a),label:"Name",rules:[a=>!!a||"Name is required"],required:""},null,8,["modelValue","rules"]),s(r,{modelValue:e.UsersDetail.email,"onUpdate:modelValue":l[1]||(l[1]=a=>e.UsersDetail.email=a),label:"Email",rules:[a=>!!a||"Email is required",a=>/.+@.+\..+/.test(a)||"Email must be valid"],required:""},null,8,["modelValue","rules"]),s(r,{modelValue:e.UsersDetail.username,"onUpdate:modelValue":l[2]||(l[2]=a=>e.UsersDetail.username=a),label:"Username",rules:[a=>!!a||"Username is required"],required:""},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"12",md:"6"},{default:t(()=>[s(r,{modelValue:e.UsersDetail.phone,"onUpdate:modelValue":l[3]||(l[3]=a=>e.UsersDetail.phone=a),label:"Phone"},null,8,["modelValue"]),s(r,{modelValue:e.UsersDetail.dob,"onUpdate:modelValue":l[4]||(l[4]=a=>e.UsersDetail.dob=a),label:"Date of Birth",type:"date"},null,8,["modelValue"]),s(r,{modelValue:e.UsersDetail.address,"onUpdate:modelValue":l[5]||(l[5]=a=>e.UsersDetail.address=a),label:"Address"},null,8,["modelValue"])]),_:1})]),_:1}),s(u,null,{default:t(()=>[s(n,{cols:"12",md:"4"},{default:t(()=>[s(r,{modelValue:e.UsersDetail.current_password,"onUpdate:modelValue":l[6]||(l[6]=a=>e.UsersDetail.current_password=a),label:"Current Password",type:"password",rules:[a=>!a||a.length>=8||"Password must be at least 8 characters"]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"12",md:"4"},{default:t(()=>[s(r,{modelValue:e.UsersDetail.new_password,"onUpdate:modelValue":l[7]||(l[7]=a=>e.UsersDetail.new_password=a),label:"New Password",type:"password",rules:[a=>!a||a.length>=8||"Password must be at least 8 characters"]},null,8,["modelValue","rules"])]),_:1}),s(n,{cols:"12",md:"4"},{default:t(()=>[s(r,{modelValue:e.UsersDetail.new_password_confirmation,"onUpdate:modelValue":l[8]||(l[8]=a=>e.UsersDetail.new_password_confirmation=a),label:"Confirm New Password",type:"password",rules:[a=>!a||a===e.UsersDetail.new_password||"Passwords must match"]},null,8,["modelValue","rules"])]),_:1})]),_:1}),s(u,null,{default:t(()=>[s(n,{cols:"12",md:"4"},{default:t(()=>[s(_,{to:{name:"FaceModelList",params:{id:e.userId}}},{default:t(()=>l[11]||(l[11]=[d(" Manage Face Models ")])),_:1},8,["to"])]),_:1}),s(n,{cols:"12",md:"4"},{default:t(()=>[s(_,{color:"primary",type:"submit",loading:e.saving,disabled:!e.valid,onClick:e.saveUsersDetail},{default:t(()=>l[12]||(l[12]=[d(" Save Changes ")])),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(u,{class:"mt-4"},{default:t(()=>[(i(!0),p(c,null,V(e.additionalData,(a,g)=>(i(),m(n,{key:g,cols:"12",md:"4"},{default:t(()=>[s(w,null,{default:t(()=>[s(U,null,{default:t(()=>[d(f(e.formatKey(g)),1)]),_:2},1024),s(D,null,{default:t(()=>[s(C,null,{default:t(()=>[(i(!0),p(c,null,V(e.isObject(a)?a:[],(j,v)=>(i(),m(k,{key:v},{default:t(()=>[s(I,null,{default:t(()=>[d(f(e.formatSubKey(v)),1)]),_:2},1024),s(P,null,{default:t(()=>[d(f(j),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["menu-items","onLogout"])}const Z=S(B,[["render",L]]);export{Z as default};
