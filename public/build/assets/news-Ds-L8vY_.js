import{d as f,_ as v,r as o,g as l,o as r,w as n,e as s,h as c,f as g,c as _,F as b,j as D,k as I,b as A}from"./app-ClbCorYk.js";import{D as B,m as j}from"./menu-DXkp5gbb.js";const q=f({name:"NewsList",props:{items:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1},currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0}},methods:{formatDate(e){try{if(!e)return"No date";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";const i={year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString(void 0,i)}catch(t){return console.error("Error formatting date:",t),"Invalid date"}}},mounted(){console.log("NewsList items:",this.items)}}),F={key:2,class:"text-center pa-4"};function S(e,t,i,w,h,y){const u=o("v-spacer"),d=o("v-icon"),m=o("v-btn"),p=o("v-card-title"),N=o("v-progress-linear"),P=o("v-list-item"),$=o("v-list"),C=o("v-card-text"),k=o("v-pagination"),L=o("v-card-actions"),V=o("v-card");return r(),l(V,null,{default:n(()=>[s(p,null,{default:n(()=>[t[5]||(t[5]=g(" News ")),s(u),s(m,{color:"primary",onClick:t[0]||(t[0]=a=>e.$emit("create"))},{default:n(()=>[s(d,{left:""},{default:n(()=>t[3]||(t[3]=[g("mdi-plus")])),_:1}),t[4]||(t[4]=g(" Create News "))]),_:1})]),_:1}),s(C,null,{default:n(()=>[e.loading?(r(),l(N,{key:0,indeterminate:"",color:"primary"})):c("",!0),e.items&&e.items.length>0?(r(),l($,{key:1},{default:n(()=>[(r(!0),_(b,null,D(e.items,a=>(r(),l(P,{key:a.id,onClick:R=>e.$emit("view",a.id),title:a.title,subtitle:e.formatDate(a.created_at)},null,8,["onClick","title","subtitle"]))),128))]),_:1})):e.loading?c("",!0):(r(),_("div",F,t[6]||(t[6]=[I("p",null,"No news items found",-1)])))]),_:1}),e.totalPages>1?(r(),l(L,{key:0,class:"justify-center pa-4"},{default:n(()=>[s(k,{modelValue:e.currentPage,"onUpdate:modelValue":[t[1]||(t[1]=a=>e.currentPage=a),t[2]||(t[2]=a=>e.$emit("page-change",a))],length:e.totalPages,"total-visible":7,color:"primary"},null,8,["modelValue","length"])]),_:1})):c("",!0)]),_:1})}const T=v(q,[["render",S]]),E=f({name:"News",components:{DefaultLayout:B,NewsList:T},data(){return{news:[],menuItems:j,loading:!1,currentPage:1,totalPages:1,perPage:20}},methods:{async fetchNews(e=1){try{this.loading=!0;const t=await A.get("/api/news",{params:{page:e,per_page:this.perPage},headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("API Response:",t.data),Array.isArray(t.data.data)?(this.news=t.data.data,this.currentPage=t.data.current_page,this.totalPages=t.data.last_page):(console.error("Invalid response format:",t.data),this.news=[])}catch(t){console.error("Failed to fetch news:",t),this.news=[]}finally{this.loading=!1}},handlePageChange(e){this.fetchNews(e)},viewNews(e){this.$router.push({name:"NewsDetail",params:{id:e}})},createNews(){this.$router.push({name:"CreateNews"})},logout(){localStorage.removeItem("auth_token"),this.$router.push({name:"Login"})}},mounted(){this.fetchNews()}});function z(e,t,i,w,h,y){const u=o("news-list"),d=o("v-col"),m=o("v-row"),p=o("default-layout");return r(),l(p,{title:"News","menu-items":e.menuItems,onLogout:e.logout},{default:n(()=>[s(m,null,{default:n(()=>[s(d,{cols:"12"},{default:n(()=>[s(u,{items:e.news,loading:e.loading,"total-pages":e.totalPages,"current-page":e.currentPage,onView:e.viewNews,onCreate:e.createNews,onPageChange:e.handlePageChange},null,8,["items","loading","total-pages","current-page","onView","onCreate","onPageChange"])]),_:1})]),_:1})]),_:1},8,["menu-items","onLogout"])}const H=v(E,[["render",z]]);export{H as default};
