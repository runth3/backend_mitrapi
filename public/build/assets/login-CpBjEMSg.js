import{d as b,_ as w,c,n as v,V,o as g,w as u,m as S,a as C,r as h,b as m,e as y,f as L,g as U,h as f,i as d,j as k,k as B,l as $,t as I,p as A,u as P,q as F,s as T,v as q,x as K,y as M}from"./main-iU3nZ3Bq.js";import{B as N,u as j}from"./useAuth-Ij3fNG1k.js";import{B as z}from"./BaseCard-DooXeZpV.js";const D=b({name:"BaseInput",props:{modelValue:{type:[String,Number],default:""},color:{type:String,default:"primary"},label:{type:String,default:""},variant:{type:String,default:"outlined"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:""},type:{type:String,default:"text"},customClass:{type:String,default:""},rounded:{type:String,default:"lg"},rules:{type:Array,default:()=>[]}},emits:["update:modelValue","input"]});function E(e,o,t,n,l,i){return g(),c(V,{"model-value":e.modelValue,color:e.color,label:e.label,variant:e.variant,disabled:e.disabled,readonly:e.readonly,placeholder:e.placeholder,type:e.type,rules:e.rules,rounded:e.rounded,class:v(e.customClass),"onUpdate:modelValue":o[0]||(o[0]=a=>e.$emit("update:modelValue",a)),onInput:o[1]||(o[1]=a=>e.$emit("input",a))},null,8,["model-value","color","label","variant","disabled","readonly","placeholder","type","rules","rounded","class"])}const R=w(D,[["render",E]]),G=b({name:"BaseAlert",props:{type:{type:String,default:"info"},textColor:{type:String,default:"on-surface"},density:{type:String,default:"compact"},closable:{type:Boolean,default:!1}},inheritAttrs:!1});function H(e,o,t,n,l,i){return g(),c(C,S({type:e.type,"text-color":e.textColor,density:e.density,closable:e.closable},e.$attrs),{default:u(()=>[h(e.$slots,"default")]),_:3},16,["type","text-color","density","closable"])}const J=w(G,[["render",H]]),O=b({name:"LoginForm",components:{BaseInput:R,BaseButton:N,BaseAlert:J},props:{username:{type:String,default:""},password:{type:String,default:""},error:{type:[String,null],default:null},loading:{type:Boolean,default:!1}},emits:["update:username","update:password","update:error","submit"],setup(e,{emit:o}){const t=m(e.username),n=m(e.password),l=m(null);y(()=>e.username,a=>{t.value=a}),y(()=>e.password,a=>{n.value=a}),y(t,a=>{o("update:username",a)}),y(n,a=>{o("update:password",a)});function i(a){if(a.preventDefault(),l.value){const s=l.value.$el.querySelector("input");s&&s.focus()}}return{localUsername:t,localPassword:n,passwordInput:l,moveToPassword:i}}});function Q(e,o,t,n,l,i){const a=f("BaseInput"),s=f("BaseButton"),p=f("BaseAlert");return g(),c(U,{onSubmit:o[4]||(o[4]=L(r=>e.$emit("submit"),["prevent"]))},{default:u(()=>[d(a,{modelValue:e.localUsername,"onUpdate:modelValue":o[0]||(o[0]=r=>e.localUsername=r),label:"Username",color:"primary",type:"text",rounded:"lg",class:"mb-4",rules:[r=>!!r||"Username is required"],onKeypress:B(e.moveToPassword,["enter"])},null,8,["modelValue","rules","onKeypress"]),d(a,{ref:"passwordInput",modelValue:e.localPassword,"onUpdate:modelValue":o[1]||(o[1]=r=>e.localPassword=r),label:"Password",color:"primary",type:"password",rounded:"lg",class:"mb-4",rules:[r=>!!r||"Password is required"],onKeypress:o[2]||(o[2]=B(r=>e.$emit("submit"),["enter"]))},null,8,["modelValue","rules"]),d(s,{type:"submit",size:"default",color:"primary",block:"",rounded:"lg","prepend-icon":"mdi-login",loading:e.loading,disabled:e.loading||!e.localUsername||!e.localPassword},{default:u(()=>o[5]||(o[5]=[$(" Login ")])),_:1},8,["loading","disabled"]),e.error?(g(),c(p,{key:0,type:"error","text-color":"on-surface",class:"mt-4 text-body-2",density:"compact",closable:"","onClick:close":o[3]||(o[3]=r=>e.$emit("update:error",null))},{default:u(()=>[$(I(e.error),1)]),_:1})):k("",!0)]),_:1})}const W=w(O,[["render",Q]]),X=b({name:"Login",components:{LoginForm:W,BaseCard:z},setup(){const e=P(),o=m(""),t=m(""),{login:n,error:l,loading:i}=j();A(()=>{const s=localStorage.getItem("auth_token");console.log("onMounted: auth_token exists:",!!s),s&&(console.log("Redirecting to /dashboard from onMounted"),e.push("/dashboard"))});async function a(){console.log("handleLogin called with username:",o.value);try{await n(o.value,t.value),console.log("Login successful, should be redirected by useAuth")}catch(s){console.error("Login failed in handleLogin:",s)}}return{username:o,password:t,error:l,loading:i,handleLogin:a}}}),Y={class:"login-background"};function Z(e,o,t,n,l,i){const a=f("LoginForm"),s=f("BaseCard");return g(),F("div",Y,[d(T,{class:"d-flex justify-center align-center pa-5",style:{"min-height":"100vh",height:"100%"}},{default:u(()=>[d(s,{class:"pa-5 login-card","max-width":"600",width:"100%",style:{"min-width":"400px"}},{default:u(()=>[d(q,{src:"/images/logo.png","max-width":"150",class:"mx-auto mb-4"}),d(K,{class:"text-h5 text-center"},{default:u(()=>o[3]||(o[3]=[$("Login")])),_:1}),d(M,null,{default:u(()=>[d(a,{username:e.username,"onUpdate:username":o[0]||(o[0]=p=>e.username=p),password:e.password,"onUpdate:password":o[1]||(o[1]=p=>e.password=p),error:e.error,"onUpdate:error":o[2]||(o[2]=p=>e.error=p),loading:e.loading,onSubmit:e.handleLogin},null,8,["username","password","error","loading","onSubmit"])]),_:1})]),_:1})]),_:1})])}const oe=w(X,[["render",Z],["__scopeId","data-v-01afdc0f"]]);export{oe as default};
