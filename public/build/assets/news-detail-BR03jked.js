import{d as D,b as m,_ as N,r as o,g as i,o as l,w as a,e as r,h as f,f as c,t as u,k as d}from"./app-ClbCorYk.js";import{D as S,m as I}from"./menu-DXkp5gbb.js";const L=D({name:"NewsDetail",components:{DefaultLayout:S},data(){return{news:null,loading:!1,menuItems:I,snackbar:!1,snackbarText:"",snackbarColor:"success",isAuthenticated:!1}},methods:{showSnackbar(e,t="success"){this.snackbarText=e,this.snackbarColor=t,this.snackbar=!0},async checkAuth(){const e=localStorage.getItem("token");if(!e)return this.$router.push({name:"Login"}),!1;try{return(await m.get("/api/user",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${e}`}})).data?(this.isAuthenticated=!0,!0):(this.logout(),!1)}catch(t){return console.error("Authentication check failed:",t),this.logout(),!1}},async fetchNewsDetail(){var e,t,n;if(await this.checkAuth()){this.loading=!0;try{const s=this.$route.params.id,h=await m.get(`/api/news/${s}`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});this.news=h.data}catch(s){if(console.error("Failed to fetch news detail:",s),((e=s.response)==null?void 0:e.status)===401){this.logout();return}this.showSnackbar(((n=(t=s.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch news detail","error")}finally{this.loading=!1}}},logout(){localStorage.removeItem("token"),this.$router.push({name:"Login"})},async initializePage(){this.loading=!0;try{await this.checkAuth()?await this.fetchNewsDetail():(this.showSnackbar("Please login to continue","error"),this.$router.push({name:"Login"}))}catch(e){console.error("Initialization error:",e),this.showSnackbar("Failed to initialize page","error")}finally{this.loading=!1}}},async created(){await this.initializePage()},beforeRouteEnter(e,t,n){localStorage.getItem("token")?n():n({name:"Login"})},async beforeRouteUpdate(e,t,n){n(),await this.fetchNewsDetail()}});function V(e,t,n,s,h,z){const g=o("v-card-title"),k=o("v-img"),w=o("v-card-text"),_=o("v-card"),b=o("v-skeleton-loader"),v=o("v-col"),y=o("v-row"),A=o("v-btn"),$=o("v-snackbar"),C=o("default-layout");return l(),i(C,{title:"News Detail","menu-items":e.menuItems,onLogout:e.logout},{default:a(()=>[r(y,null,{default:a(()=>[r(v,{cols:"12"},{default:a(()=>[e.news?(l(),i(_,{key:0},{default:a(()=>[r(g,null,{default:a(()=>[c(u(e.news.title),1)]),_:1}),r(w,null,{default:a(()=>[e.news.image_url?(l(),i(k,{key:0,src:e.news.image_url,height:"300",cover:"",class:"mb-4"},null,8,["src"])):f("",!0),d("p",null,u(e.news.content),1),d("p",null,[t[2]||(t[2]=d("strong",null,"Published on:",-1)),c(" "+u(e.news.created_at),1)])]),_:1})]),_:1})):e.loading?(l(),i(b,{key:1,type:"article"})):f("",!0)]),_:1})]),_:1}),r($,{modelValue:e.snackbar,"onUpdate:modelValue":t[1]||(t[1]=p=>e.snackbar=p),color:e.snackbarColor,timeout:3e3,top:!0,right:!0},{actions:a(()=>[r(A,{color:"white",text:"",onClick:t[0]||(t[0]=p=>e.snackbar=!1)},{default:a(()=>t[3]||(t[3]=[c(" Close ")])),_:1})]),default:a(()=>[c(u(e.snackbarText)+" ",1)]),_:1},8,["modelValue","color"])]),_:1},8,["menu-items","onLogout"])}const j=N(L,[["render",V],["__scopeId","data-v-dda64c4c"]]);export{j as default};
