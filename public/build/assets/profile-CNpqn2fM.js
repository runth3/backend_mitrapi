import{d as y,b as d,_,r,g as n,o as i,w as t,e as a,f as u,i as P}from"./app-ClbCorYk.js";import{D as U,m as c}from"./menu-DXkp5gbb.js";const C=y({name:"Profile",components:{DefaultLayout:U},data(){return{menuItems:c,loading:!1,saving:!1,valid:!1,profile:{name:"",email:"",username:"",phone:"",dob:"",address:"",current_password:"",new_password:"",new_password_confirmation:""}}},methods:{async fetchProfile(){try{this.loading=!0;const e=await d.get("/api/profile/me",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e.data),this.profile.name=e.data.user.name,this.profile.email=e.data.user.email,this.profile.username=e.data.user.username,this.profile.phone=e.data.user.phone,this.profile.dob=e.data.user.dob,this.profile.address=e.data.user.address}catch(e){console.error("Failed to fetch profile:",e)}finally{this.loading=!1}},async saveProfile(){if(this.valid)try{this.saving=!0,await d.put("/api/profile/",this.profile,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),this.profile.current_password="",this.profile.new_password="",this.profile.new_password_confirmation=""}catch(e){console.error("Failed to save profile:",e)}finally{this.saving=!1}},logout(){localStorage.removeItem("token"),this.$router.push({name:"Login"})}},mounted(){this.fetchProfile()}});function k(e,l,S,$,q,N){const p=r("v-card-title"),m=r("v-progress-linear"),s=r("v-text-field"),f=r("v-btn"),w=r("v-form"),v=r("v-card-text"),V=r("v-card"),g=r("v-col"),b=r("v-row"),h=r("default-layout");return i(),n(h,{title:"Profile","menu-items":e.menuItems,onLogout:e.logout},{default:t(()=>[a(b,null,{default:t(()=>[a(g,{cols:"12",md:"6","offset-md":"3"},{default:t(()=>[a(V,null,{default:t(()=>[a(p,null,{default:t(()=>l[10]||(l[10]=[u("Profile Settings")])),_:1}),a(v,null,{default:t(()=>[e.loading?(i(),n(m,{key:0,indeterminate:"",color:"primary"})):(i(),n(w,{key:1,ref:"form",modelValue:e.valid,"onUpdate:modelValue":l[9]||(l[9]=o=>e.valid=o),onSubmit:P(e.saveProfile,["prevent"])},{default:t(()=>[a(s,{modelValue:e.profile.name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.profile.name=o),label:"Name",rules:[o=>!!o||"Name is required"],required:""},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.email,"onUpdate:modelValue":l[1]||(l[1]=o=>e.profile.email=o),label:"Email",rules:[o=>!!o||"Email is required",o=>/.+@.+\..+/.test(o)||"Email must be valid"],required:""},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.username,"onUpdate:modelValue":l[2]||(l[2]=o=>e.profile.username=o),label:"Username",rules:[o=>!!o||"Username is required"],required:""},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.phone,"onUpdate:modelValue":l[3]||(l[3]=o=>e.profile.phone=o),label:"Phone"},null,8,["modelValue"]),a(s,{modelValue:e.profile.dob,"onUpdate:modelValue":l[4]||(l[4]=o=>e.profile.dob=o),label:"Date of Birth",type:"date"},null,8,["modelValue"]),a(s,{modelValue:e.profile.address,"onUpdate:modelValue":l[5]||(l[5]=o=>e.profile.address=o),label:"Address"},null,8,["modelValue"]),a(s,{modelValue:e.profile.current_password,"onUpdate:modelValue":l[6]||(l[6]=o=>e.profile.current_password=o),label:"Current Password",type:"password",rules:[o=>!o||o.length>=8||"Password must be at least 8 characters"]},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.new_password,"onUpdate:modelValue":l[7]||(l[7]=o=>e.profile.new_password=o),label:"New Password",type:"password",rules:[o=>!o||o.length>=8||"Password must be at least 8 characters"]},null,8,["modelValue","rules"]),a(s,{modelValue:e.profile.new_password_confirmation,"onUpdate:modelValue":l[8]||(l[8]=o=>e.profile.new_password_confirmation=o),label:"Confirm New Password",type:"password",rules:[o=>!o||o===e.profile.new_password||"Passwords must match"]},null,8,["modelValue","rules"]),a(f,{color:"primary",type:"submit",loading:e.saving,disabled:!e.valid},{default:t(()=>l[11]||(l[11]=[u(" Save Changes ")])),_:1},8,["loading","disabled"])]),_:1},8,["modelValue","onSubmit"]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["menu-items","onLogout"])}const I=_(C,[["render",k]]);export{I as default};
